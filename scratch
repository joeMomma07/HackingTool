import os
import tempfile
from fpdf import FPDF
from pdf2docx import Converter
from docx2pdf import convert

def add_backdoor(file_path):
    # Add your backdoor code here
    pass

def pdf_to_word(pdf_path, word_path):
    doc = fitz.open(pdf_path)
    docx = Document()

    for page in doc:
        docx.add_paragraph(page.get_text())

    docx.save(word_path)
    add_backdoor(word_path)

def word_to_pdf(word_path, pdf_path):
    converter = Converter(word_path)
    docx_content = converter.convert()

    pdf = FPDF()
    pdf.add_page()
    pdf.set_font("Arial", size=12)

    for line in docx_content.split('\n'):
        pdf.cell(0, 10, line, ln=True)

    pdf.output(pdf_path)
    add_backdoor(pdf_path)

if __name__ == "__main__":
    # Testing the program
    pdf_to_word("sample.pdf", "output.docx")
    word_to_pdf("output.docx", "output.pdf")
